{"version":3,"sources":["../../src/pages/add-observation/add-observation.module.ts","../../src/pages/add-observation/add-observation.ts"],"names":[],"mappings":"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","file":"11.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { AddObservationPage } from './add-observation';\nimport { TranslateModule, TranslateLoader } from '@ngx-translate/core';\nimport { TranslateHttpLoader } from '@ngx-translate/http-loader';\nimport { HttpModule,Http } from '@angular/http';\n\nexport function createTranslateLoader(http: Http) {\n  return new TranslateHttpLoader(http, './assets/i18n/', '.json');\n}\n\n@NgModule({\n  declarations: [\n    AddObservationPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(AddObservationPage),\n    TranslateModule.forChild({\n      loader: {\n                provide: TranslateLoader,\n                useFactory: (createTranslateLoader),\n                deps: [Http]\n              }\n    })\n  ],\n})\nexport class AddObservationPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-observation/add-observation.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, Events } from 'ionic-angular';\nimport { NativeStorage } from '@ionic-native/native-storage';\nimport { TranslateService } from '@ngx-translate/core';\nimport { Network } from '@ionic-native/network';\nimport { SQLite, SQLiteObject } from '@ionic-native/sqlite';\nimport { File } from '@ionic-native/file';\n\n\nimport {PhenoApi} from '../../providers/pheno-api/pheno-api';\n\n/**\n * Generated class for the AddObservationPage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-add-observation',\n  templateUrl: 'add-observation.html',\n})\nexport class AddObservationPage {\n\n  public species:any;\n  private user:any;\n  private networkStatus:any=0;\n  private offlineSpecies:any=[];\n  private offlineFileDirectory:any;\n\n  constructor(\n    public navCtrl: NavController, \n    public navParams: NavParams ,\n    private translate: TranslateService,\n    private phenoApi:PhenoApi,\n    private nativeStorage: NativeStorage,\n    private network: Network, \n    private events:Events,\n    private sqlite: SQLite,\n    private file:File\n  \n  ) {\n    \n    this.offlineFileDirectory=this.file.dataDirectory;\n\n }\n  \n  ionViewWillEnter(){\n    this.getUserFromStorage();\n    this.checkNetwork();\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad AddObservationPage');\n  }\n\n  //check current network status and subscribe to events\n  checkNetwork(){\n    if (this.network.type === 'none') {\n      console.log('we have no connection!');\n      this.networkStatus=0;\n      this.getOfflineSpecies();\n    }else{\n      this.networkStatus=1;\n      this.getSpecies();\n    }\n\n    //listen for user disconnection event\n     this.events.subscribe('network:disconnected', (e) => {\n      this.networkStatus=0;\n      this.getOfflineSpecies();\n    });\n\n    //listen for user disconnection event\n    this.events.subscribe('network:connected', (e) => {\n      this.networkStatus=1;\n      this.getSpecies();\n      //this.getObservations(this.filter,this.limit,this.school,this.userfilter);\n    });\n  }\n\n  getSpecies(){\n    if(this.networkStatus==1){\n      this.phenoApi.getSpecies().subscribe(\n        data => {this.species=data},\n        err => console.error(err),\n        () => {console.log(this.species)}\n      );\n    }else{\n      console.log(\"No network! \"+this.networkStatus);\n    }\n  }\n\n  //getting the offline stored data\n  getOfflineSpecies(){\n      this.sqlite.create({\n      name: 'phenologit.db',\n      location: 'default'\n    })\n    .then((db: SQLiteObject) => {\n      db.executeSql('SELECT * FROM species_offline', {})\n          .then((data) => {\n            console.log(\"full offline species got\");\n            for(let i = 0; i < data.rows.length; i++) {\n              this.offlineSpecies.push({\n                \"id\": data.rows.item(i).id,\n                \"name\": data.rows.item(i).name,\n                \"name_en\": data.rows.item(i).name_en,\n                \"name_gl\": data.rows.item(i).name_gl,\n                \"name_dk\": data.rows.item(i).name_dk,\n                \"name_lt\": data.rows.item(i).name_lt,\n                \"name_es\": data.rows.item(i).name_es,\n                \"thumbnail\": data.rows.item(i).thumbnail,\n                \"picture\": data.rows.item(i).pictures,\n                \"stages\": data.rows.item(i).stages,\n              });\n            }\n          })\n          .catch(e => console.log(e));\n      });\n  }\n\n  openSpeciePage(id){\n    console.log('opening specie '+id);\n    this.nativeStorage.setItem('observation',{specie:id});\n    this.navCtrl.push('SpeciePage',{id:id});\n  }\n  \n  getUserFromStorage(){\n    console.log(\"getting user from storage\");\n    this.nativeStorage.getItem('user')\n    .then(\n      data => {\n        this.user=data;\n        console.log('got from storage: '+JSON.stringify(data));\n        if(this.user.username==null || this.user.username==undefined){\n          this.navCtrl.push('LoginPage',{destination:'AddObservationPage'});\n        }\n      },\n      error => {\n        this.navCtrl.push('LoginPage',{destination:'AddObservationPage'});\n        console.error(error)}\n    );\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-observation/add-observation.ts"],"sourceRoot":""}