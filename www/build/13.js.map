{"version":3,"sources":["../../src/pages/add-observation-specie/specie.module.ts","../../src/pages/add-observation-specie/specie.ts"],"names":[],"mappings":"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","file":"13.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { SpeciePage } from './specie';\nimport { TranslateModule, TranslateLoader } from '@ngx-translate/core';\nimport { TranslateHttpLoader } from '@ngx-translate/http-loader';\nimport { HttpModule,Http } from '@angular/http';\n\nexport function createTranslateLoader(http: Http) {\n  return new TranslateHttpLoader(http, './assets/i18n/', '.json');\n}\n\n@NgModule({\n  declarations: [\n    SpeciePage,\n  ],\n  imports: [\n    IonicPageModule.forChild(SpeciePage),\n    TranslateModule.forChild({\n      loader: {\n                provide: TranslateLoader,\n                useFactory: (createTranslateLoader),\n                deps: [Http]\n              }\n    })\n  ],\n})\nexport class SpeciePageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-observation-specie/specie.module.ts","import { Component, ViewChild } from '@angular/core';\nimport { IonicPage, NavController, NavParams, Slides, Events } from 'ionic-angular';\nimport { NativeStorage } from '@ionic-native/native-storage';\nimport { TranslateService } from '@ngx-translate/core';\nimport { Network } from '@ionic-native/network';\nimport { SQLite, SQLiteObject } from '@ionic-native/sqlite';\nimport { File } from '@ionic-native/file';\n\nimport {PhenoApi} from '../../providers/pheno-api/pheno-api';\n\n\n\n/**\n * Generated class for the SpeciePage page.\n *\n * See https://ionicframework.com/docs/components/#navigation for more info on\n * Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-specie',\n  templateUrl: 'specie.html',\n})\nexport class SpeciePage {\n\n  @ViewChild('myslider') slider:  Slides;\n\n  private specie: any;\n  private stage_id:any=0;\n  public stageIndex:any=0;\n  private networkStatus;\n\n  constructor(\n    public navCtrl: NavController, \n    public navParams: NavParams,\n    private phenoApi: PhenoApi,\n    private translate: TranslateService,\n    private nativeStorage: NativeStorage,\n    private network: Network,\n    private events:Events,\n    private sqlite: SQLite,\n    private file:File\n  ) {\n    console.log('constructor');\n    this.specie=[];\n    this.specie.picture=null;\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad SpeciePage');\n    this.checkNetwork();\n  }\n\n  //check current network status and subscribe to events\n  checkNetwork(){\n    if (this.network.type === 'none') {\n      console.log('we have no connection!');\n      this.networkStatus=0;\n      this.getOfflineSpecieDetails();\n    }else{\n      this.networkStatus=1;\n      this.getSpecieDetails(this.navParams.get('id'));\n    }\n\n    //listen for user disconnection event\n     this.events.subscribe('network:disconnected', (e) => {\n      this.networkStatus=0;\n      this.getOfflineSpecieDetails();\n    });\n\n    //listen for user disconnection event\n    this.events.subscribe('network:connected', (e) => {\n      this.networkStatus=1;\n      this.getSpecieDetails(this.navParams.get('id'));\n\n    });\n  }\n\n  getSpecieDetails(id){ //get specie details from API\n    console.log('going to check details for '+id);\n      this.phenoApi.getSpecieDetails(id).subscribe(\n        data => {this.specie=data[0]},\n        err => {},\n        () => console.log(this.specie)\n      );\n  }\n\n  getOfflineSpecieDetails(){ //get specie details from sqlite storage\n    let self=this;\n    console.log('going to check OFFLINE details for '+this.navParams.get('id'));\n    this.sqlite.create({\n      name: 'phenologit.db',\n      location: 'default'\n    })\n    .then((db: SQLiteObject) => {\n      db.executeSql('SELECT * FROM species_offline WHERE id='+this.navParams.get('id')+'', {})\n          .then((data) => {\n            console.log(\"offline specie got \"+JSON.stringify(data.rows.item(0).name));\n              this.specie={\n                \"id\": data.rows.item(0).id,\n                \"name\": data.rows.item(0).name,\n                \"name_en\": data.rows.item(0).name_en,\n                \"name_gl\": data.rows.item(0).name_gl,\n                \"name_dk\": data.rows.item(0).name_dk,\n                \"name_lt\": data.rows.item(0).name_lt,\n                \"name_es\": data.rows.item(0).name_es,\n                \"desc_en\": data.rows.item(0).desc_en,\n                \"desc_gl\": data.rows.item(0).desc_gl,\n                \"desc_dk\": data.rows.item(0).desc_dk,\n                \"desc_lt\": data.rows.item(0).desc_lt,\n                \"desc_es\": data.rows.item(0).desc_es,\n                \"thumbnail\": data.rows.item(0).thumbnail,\n                \"picture\": data.rows.item(0).pictures,\n                \"stages\":[]\n              };\n\n            //get the stages\n            db.executeSql('SELECT * FROM u_specie_stage_offline WHERE idspecie='+this.navParams.get('id')+'', {})\n            .then((data) => {\n              for(let i = 0; i < data.rows.length; i++) {\n                this.specie.stages.push({\n                  \"stage_id\": data.rows.item(i).idstage,\n                  \"stage_en\": data.rows.item(i).stage_en,\n                  \"stage_es\": data.rows.item(i).stage_es,\n                  \"stage_dk\": data.rows.item(i).stage_dk,\n                  \"stage_lt\": data.rows.item(i).stage_lt,\n                  \"desc_en\": data.rows.item(i).desc_en,\n                  \"desc_es\": data.rows.item(i).desc_es,\n                  \"desc_dk\": data.rows.item(i).desc_dk,\n                  \"desc_lt\": data.rows.item(i).desc_lt,\n                  \"stage_picture\": self.file.dataDirectory+\"/stages/\"+data.rows.item(i).stage_picture,\n                });\n              }\n            \n            })\n            .catch(e => console.log(e));\n          \n          })\n          .catch(e => console.log(e));\n      });\n  }\n\n  //uploads the selected stage id when slide changes\n  slideChanged(){\n\n    //check if this is the last slide to prevent swiping left\n    if(!this.slider.isEnd()){ \n      this.slider.lockSwipeToNext(false)\n      this.stageIndex = this.slider.getActiveIndex();\n    }else{\n      this.slider.lockSwipeToNext(true)\n      this.stageIndex = this.slider.getActiveIndex();\n    }\n\n    //check if this is the first slide to prevent swiping right\n    if(!this.slider.isBeginning()){ \n      this.slider.lockSwipeToPrev(false)\n      this.stageIndex = this.slider.getActiveIndex();\n    }else{\n      this.slider.lockSwipeToPrev(true)\n      this.stageIndex = this.slider.getActiveIndex();\n    }\n\n    console.log('#active slide index: '+this.stageIndex);\n    \n  }\n\n  openObservationMedia(stage){\n    console.log('stage-> '+ stage);\n    //get observation storage\n    this.nativeStorage.getItem('observation')\n      .then(\n        data => {\n          this.saveData(data,stage),\n          this.navCtrl.push('AddObservationDetailsPage',{id:this.navParams.get('id')})\n        },\n        error => console.error(error)\n    );\n    \n  }\n\n  saveData(data,stage){\n    this.nativeStorage.setItem('observation',{specie:data.specie,stage:stage});\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/add-observation-specie/specie.ts"],"sourceRoot":""}